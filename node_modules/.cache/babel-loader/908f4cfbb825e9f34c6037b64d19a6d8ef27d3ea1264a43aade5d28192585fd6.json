{"ast":null,"code":"var _jsxFileName = \"/Users/admin/Downloads/Package_Realease_15-5-2023/sources code/resonus-fe/src/app/Camera/camera.jsx\",\n  _s = $RefreshSig$();\nimport { css, cx } from \"@emotion/css\";\nimport { useRef, useState } from \"react\";\nimport Webcam from \"react-webcam\";\nimport { isTablet, isMobile } from \"react-device-detect\";\nimport { useContextCustom } from \"../../utils/store/hooks\";\nimport { RecordRTCPromisesHandler } from \"recordrtc\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Camera = () => {\n  _s();\n  const [status, setStatus] = useState(true);\n  const [timeStart, setTimeStart] = useState(-1);\n  const [isReady, setIsReady] = useState(false);\n  const webcamRef = useRef(null);\n  const mediaRecorderRef = useRef(null);\n  const intervalRef = useRef(null);\n  const [screens, dispatch] = useContextCustom(state => state.screens);\n  const navigate = useNavigate();\n  const handleStart = () => {\n    let timer = 3;\n    setTimeStart(3);\n    mediaRecorderRef.current = new RecordRTCPromisesHandler(webcamRef.current.stream, {\n      type: \"video\",\n      mimeType: \"video/mp4\"\n    });\n    mediaRecorderRef.current.startRecording();\n    intervalRef.current = setInterval(async () => {\n      if (timer === 0) {\n        setTimeStart(0);\n        clearInterval(intervalRef.current);\n        await mediaRecorderRef.current.stopRecording();\n        const blob = await mediaRecorderRef.current.getBlob();\n        const file = new File([blob], \"resonus.mp4\", {\n          type: \"video/mp4\"\n        });\n        dispatch({\n          type: \"ADD_FILE\",\n          payload: file\n        });\n        dispatch({\n          type: \"ADD_URL\",\n          payload: URL.createObjectURL(file)\n        });\n        navigate(\"/upload\");\n      } else {\n        setTimeStart(prev => --prev);\n        timer = --timer;\n      }\n    }, 1000);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: `w-full relative ${screens > 1 ? \"pt-[75%]\" : \"pt-[133.33%]\"} overflow-hidden`,\n      children: [/*#__PURE__*/_jsxDEV(Webcam, {\n        mirrored: status,\n        onUserMedia: () => setIsReady(true),\n        videoConstraints: screens < 1 ? {\n          facingMode: status ? \"user\" : \"environment\"\n          // frameRate: { ideal: 5, max: 15 },\n        } : {\n          facingMode: status ? \"user\" : \"environment\"\n          // frameRate: { ideal: 5, max: 15 },\n        },\n\n        ref: webcamRef,\n        className: \"absolute top-0 w-full\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute top-0 left-0 right-0 bottom-0 flex justify-center items-center\",\n        children: screens > 1 ? /*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"w-[95%]\",\n          alt: \"\",\n          src: `/assets/icons/personPC.svg`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"w-full\",\n          alt: \"\",\n          src: `/assets/icons/person.svg`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-white w-full h-36 lg:h-[310px] flex flex-col justify-center items-center relative\",\n      children: [timeStart === -1 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs lg:text-base\",\n        children: \"3\\u79D2\\u306E\\u52D5\\u753B\\u3092\\u30A2\\u30C3\\u30D7\\u30ED\\u30FC\\u30C9\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-[34px] lg:text-[50px]\",\n        children: \"\\u64AE\\u5F71\\u6642\\u9593\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 11\n      }, this), timeStart === -1 ? /*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"/assets/icons/camera-action.svg\",\n        alt: \"\",\n        className: \"w-[68px] h-[68px] 2xl:w-32 2xl:h-32 my-3 lg:my-6 cursor-pointer\",\n        onClick: isReady ? handleStart : () => {}\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-[34px] lg:text-[50px]\",\n        children: [timeStart, \"\\u79D2\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-[10px] lg:text-base font-normal\",\n        children: \"\\u203B\\u5199\\u771F\\u306F\\u8A3A\\u65AD\\u306E\\u307F\\u306B\\u4F7F\\u7528\\u3055\\u308C\\u307E\\u3059\\u3002\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-[10px] lg:text-base font-normal\",\n        children: \"\\u305D\\u306E\\u4ED6\\u306E\\u76EE\\u7684\\u306E\\u305F\\u3081\\u306B\\u306F\\u4F7F\\u7528\\u3055\\u308C\\u307E\\u305B\\u3093\\u3002\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), (isMobile || isTablet) && timeStart === -1 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: cx(\"w-[46px] h-[46px] rounded-full bg-[#BEDDE4] absolute flex justify-center items-center\", css`\n                top: calc(50% - 23px);\n                right: 20px;\n              `),\n        onClick: () => setStatus(prev => !prev),\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/assets/icons/toggle.svg\",\n          alt: \"\",\n          className: \"w-[27px]\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(Camera, \"j83A/ni7pYG9lQj0QnWbOwtv5/Y=\", false, function () {\n  return [useContextCustom, useNavigate];\n});\n_c = Camera;\nexport default Camera;\nvar _c;\n$RefreshReg$(_c, \"Camera\");","map":{"version":3,"names":["css","cx","useRef","useState","Webcam","isTablet","isMobile","useContextCustom","RecordRTCPromisesHandler","useNavigate","Camera","status","setStatus","timeStart","setTimeStart","isReady","setIsReady","webcamRef","mediaRecorderRef","intervalRef","screens","dispatch","state","navigate","handleStart","timer","current","stream","type","mimeType","startRecording","setInterval","clearInterval","stopRecording","blob","getBlob","file","File","payload","URL","createObjectURL","prev","facingMode"],"sources":["/Users/admin/Downloads/Package_Realease_15-5-2023/sources code/resonus-fe/src/app/Camera/camera.jsx"],"sourcesContent":["import { css, cx } from \"@emotion/css\";\r\nimport { useRef, useState } from \"react\";\r\nimport Webcam from \"react-webcam\";\r\nimport { isTablet, isMobile } from \"react-device-detect\";\r\nimport { useContextCustom } from \"../../utils/store/hooks\";\r\nimport { RecordRTCPromisesHandler } from \"recordrtc\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst Camera = () => {\r\n  const [status, setStatus] = useState(true);\r\n  const [timeStart, setTimeStart] = useState(-1);\r\n  const [isReady, setIsReady] = useState(false);\r\n  const webcamRef = useRef(null);\r\n  const mediaRecorderRef = useRef(null);\r\n  const intervalRef = useRef(null);\r\n  const [screens, dispatch] = useContextCustom((state) => state.screens);\r\n  const navigate = useNavigate();\r\n\r\n  const handleStart = () => {\r\n    let timer = 3;\r\n    setTimeStart(3);\r\n    mediaRecorderRef.current = new RecordRTCPromisesHandler(webcamRef.current.stream, {\r\n      type: \"video\",\r\n      mimeType: \"video/mp4\",\r\n    });\r\n    mediaRecorderRef.current.startRecording();\r\n    intervalRef.current = setInterval(async () => {\r\n      if (timer === 0) {\r\n        setTimeStart(0);\r\n        clearInterval(intervalRef.current);\r\n        await mediaRecorderRef.current.stopRecording();\r\n        const blob = await mediaRecorderRef.current.getBlob();\r\n        const file = new File([blob], \"resonus.mp4\", {\r\n          type: \"video/mp4\",\r\n        });\r\n        dispatch({ type: \"ADD_FILE\", payload: file });\r\n        dispatch({ type: \"ADD_URL\", payload: URL.createObjectURL(file) });\r\n        navigate(\"/upload\");\r\n      } else {\r\n        setTimeStart((prev) => --prev);\r\n        timer = --timer;\r\n      }\r\n    }, 1000);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className={`w-full relative ${screens > 1 ? \"pt-[75%]\" : \"pt-[133.33%]\"} overflow-hidden`}>\r\n        <Webcam\r\n          mirrored={status}\r\n          onUserMedia={() => setIsReady(true)}\r\n          videoConstraints={\r\n            screens < 1\r\n              ? {\r\n                  facingMode: status ? \"user\" : \"environment\",\r\n                  // frameRate: { ideal: 5, max: 15 },\r\n                }\r\n              : {\r\n                  facingMode: status ? \"user\" : \"environment\",\r\n                  // frameRate: { ideal: 5, max: 15 },\r\n                }\r\n          }\r\n          ref={webcamRef}\r\n          className=\"absolute top-0 w-full\"\r\n        />\r\n        <div className=\"absolute top-0 left-0 right-0 bottom-0 flex justify-center items-center\">\r\n          {screens > 1 ? (\r\n            <img\r\n              className=\"w-[95%]\"\r\n              alt=\"\"\r\n              src={`/assets/icons/personPC.svg`}\r\n            />\r\n          ) : (\r\n            <img\r\n              className=\"w-full\"\r\n              alt=\"\"\r\n              src={`/assets/icons/person.svg`}\r\n            />\r\n          )}\r\n        </div>\r\n      </div>\r\n      <div className=\"text-white w-full h-36 lg:h-[310px] flex flex-col justify-center items-center relative\">\r\n        {timeStart === -1 ? (\r\n          <div className=\"text-xs lg:text-base\">3秒の動画をアップロードしてください</div>\r\n        ) : (\r\n          <div className=\"text-[34px] lg:text-[50px]\">撮影時間</div>\r\n        )}\r\n        {timeStart === -1 ? (\r\n          <img\r\n            src=\"/assets/icons/camera-action.svg\"\r\n            alt=\"\"\r\n            className=\"w-[68px] h-[68px] 2xl:w-32 2xl:h-32 my-3 lg:my-6 cursor-pointer\"\r\n            onClick={isReady ? handleStart : () => {}}\r\n          />\r\n        ) : (\r\n          <div className=\"text-[34px] lg:text-[50px]\">{timeStart}秒</div>\r\n        )}\r\n        <div className=\"text-[10px] lg:text-base font-normal\">※写真は診断のみに使用されます。</div>\r\n        <div className=\"text-[10px] lg:text-base font-normal\">その他の目的のためには使用されません。</div>\r\n        {(isMobile || isTablet) && timeStart === -1 && (\r\n          <div\r\n            className={cx(\r\n              \"w-[46px] h-[46px] rounded-full bg-[#BEDDE4] absolute flex justify-center items-center\",\r\n              css`\r\n                top: calc(50% - 23px);\r\n                right: 20px;\r\n              `,\r\n            )}\r\n            onClick={() => setStatus((prev) => !prev)}\r\n          >\r\n            <img\r\n              src=\"/assets/icons/toggle.svg\"\r\n              alt=\"\"\r\n              className=\"w-[27px]\"\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\nexport default Camera;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}